(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,98183,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={assign:function(){return o},searchParamsToUrlQuery:function(){return n},urlQueryToSearchParams:function(){return l}};for(var a in s)Object.defineProperty(r,a,{enumerable:!0,get:s[a]});function n(e){let t={};for(let[r,s]of e.entries()){let e=t[r];void 0===e?t[r]=s:Array.isArray(e)?e.push(s):t[r]=[e,s]}return t}function i(e){return"string"==typeof e?e:("number"!=typeof e||isNaN(e))&&"boolean"!=typeof e?"":String(e)}function l(e){let t=new URLSearchParams;for(let[r,s]of Object.entries(e))if(Array.isArray(s))for(let e of s)t.append(r,i(e));else t.set(r,i(s));return t}function o(e,...t){for(let r of t){for(let t of r.keys())e.delete(t);for(let[t,s]of r.entries())e.append(t,s)}return e}},95057,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={formatUrl:function(){return l},formatWithValidation:function(){return c},urlObjectKeys:function(){return o}};for(var a in s)Object.defineProperty(r,a,{enumerable:!0,get:s[a]});let n=e.r(90809)._(e.r(98183)),i=/https?|ftp|gopher|file/;function l(e){let{auth:t,hostname:r}=e,s=e.protocol||"",a=e.pathname||"",l=e.hash||"",o=e.query||"",c=!1;t=t?encodeURIComponent(t).replace(/%3A/i,":")+"@":"",e.host?c=t+e.host:r&&(c=t+(~r.indexOf(":")?`[${r}]`:r),e.port&&(c+=":"+e.port)),o&&"object"==typeof o&&(o=String(n.urlQueryToSearchParams(o)));let d=e.search||o&&`?${o}`||"";return s&&!s.endsWith(":")&&(s+=":"),e.slashes||(!s||i.test(s))&&!1!==c?(c="//"+(c||""),a&&"/"!==a[0]&&(a="/"+a)):c||(c=""),l&&"#"!==l[0]&&(l="#"+l),d&&"?"!==d[0]&&(d="?"+d),a=a.replace(/[?#]/g,encodeURIComponent),d=d.replace("#","%23"),`${s}${c}${a}${d}${l}`}let o=["auth","hash","host","hostname","href","path","pathname","port","protocol","query","search","slashes"];function c(e){return l(e)}},18581,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"useMergedRef",{enumerable:!0,get:function(){return a}});let s=e.r(71645);function a(e,t){let r=(0,s.useRef)(null),a=(0,s.useRef)(null);return(0,s.useCallback)(s=>{if(null===s){let e=r.current;e&&(r.current=null,e());let t=a.current;t&&(a.current=null,t())}else e&&(r.current=n(e,s)),t&&(a.current=n(t,s))},[e,t])}function n(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let r=e(t);return"function"==typeof r?r:()=>e(null)}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},18967,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={DecodeError:function(){return f},MiddlewareNotFoundError:function(){return v},MissingStaticPage:function(){return w},NormalizeError:function(){return b},PageNotFoundError:function(){return j},SP:function(){return g},ST:function(){return p},WEB_VITALS:function(){return n},execOnce:function(){return i},getDisplayName:function(){return u},getLocationOrigin:function(){return c},getURL:function(){return d},isAbsoluteUrl:function(){return o},isResSent:function(){return x},loadGetInitialProps:function(){return h},normalizeRepeatedSlashes:function(){return m},stringifyError:function(){return y}};for(var a in s)Object.defineProperty(r,a,{enumerable:!0,get:s[a]});let n=["CLS","FCP","FID","INP","LCP","TTFB"];function i(e){let t,r=!1;return(...s)=>(r||(r=!0,t=e(...s)),t)}let l=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,o=e=>l.test(e);function c(){let{protocol:e,hostname:t,port:r}=window.location;return`${e}//${t}${r?":"+r:""}`}function d(){let{href:e}=window.location,t=c();return e.substring(t.length)}function u(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function x(e){return e.finished||e.headersSent}function m(e){let t=e.split("?");return t[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?`?${t.slice(1).join("?")}`:"")}async function h(e,t){let r=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await h(t.Component,t.ctx)}:{};let s=await e.getInitialProps(t);if(r&&x(r))return s;if(!s)throw Object.defineProperty(Error(`"${u(e)}.getInitialProps()" should resolve to an object. But found "${s}" instead.`),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return s}let g="undefined"!=typeof performance,p=g&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class f extends Error{}class b extends Error{}class j extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message=`Cannot find module for page: ${e}`}}class w extends Error{constructor(e,t){super(),this.message=`Failed to load static file for page: ${e} ${t}`}}class v extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function y(e){return JSON.stringify({message:e.message,stack:e.stack})}},73668,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"isLocalURL",{enumerable:!0,get:function(){return n}});let s=e.r(18967),a=e.r(52817);function n(e){if(!(0,s.isAbsoluteUrl)(e))return!0;try{let t=(0,s.getLocationOrigin)(),r=new URL(e,t);return r.origin===t&&(0,a.hasBasePath)(r.pathname)}catch(e){return!1}}},84508,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"errorOnce",{enumerable:!0,get:function(){return s}});let s=e=>{}},22016,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={default:function(){return f},useLinkStatus:function(){return j}};for(var a in s)Object.defineProperty(r,a,{enumerable:!0,get:s[a]});let n=e.r(90809),i=e.r(43476),l=n._(e.r(71645)),o=e.r(95057),c=e.r(8372),d=e.r(18581),u=e.r(18967),x=e.r(5550);e.r(33525);let m=e.r(91949),h=e.r(73668),g=e.r(9396);function p(e){return"string"==typeof e?e:(0,o.formatUrl)(e)}function f(t){var r;let s,a,n,[o,f]=(0,l.useOptimistic)(m.IDLE_LINK_STATUS),j=(0,l.useRef)(null),{href:w,as:v,children:y,prefetch:N=null,passHref:k,replace:L,shallow:C,scroll:S,onClick:_,onMouseEnter:M,onTouchStart:E,legacyBehavior:I=!1,onNavigate:A,ref:P,unstable_dynamicOnHover:R,...T}=t;s=y,I&&("string"==typeof s||"number"==typeof s)&&(s=(0,i.jsx)("a",{children:s}));let W=l.default.useContext(c.AppRouterContext),U=!1!==N,O=!1!==N?null===(r=N)||"auto"===r?g.FetchStrategy.PPR:g.FetchStrategy.Full:g.FetchStrategy.PPR,{href:D,as:B}=l.default.useMemo(()=>{let e=p(w);return{href:e,as:v?p(v):e}},[w,v]);if(I){if(s?.$$typeof===Symbol.for("react.lazy"))throw Object.defineProperty(Error("`<Link legacyBehavior>` received a direct child that is either a Server Component, or JSX that was loaded with React.lazy(). This is not supported. Either remove legacyBehavior, or make the direct child a Client Component that renders the Link's `<a>` tag."),"__NEXT_ERROR_CODE",{value:"E863",enumerable:!1,configurable:!0});a=l.default.Children.only(s)}let $=I?a&&"object"==typeof a&&a.ref:P,G=l.default.useCallback(e=>(null!==W&&(j.current=(0,m.mountLinkInstance)(e,D,W,O,U,f)),()=>{j.current&&((0,m.unmountLinkForCurrentNavigation)(j.current),j.current=null),(0,m.unmountPrefetchableInstance)(e)}),[U,D,W,O,f]),F={ref:(0,d.useMergedRef)(G,$),onClick(t){I||"function"!=typeof _||_(t),I&&a.props&&"function"==typeof a.props.onClick&&a.props.onClick(t),!W||t.defaultPrevented||function(t,r,s,a,n,i,o){if("undefined"!=typeof window){let c,{nodeName:d}=t.currentTarget;if("A"===d.toUpperCase()&&((c=t.currentTarget.getAttribute("target"))&&"_self"!==c||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||t.nativeEvent&&2===t.nativeEvent.which)||t.currentTarget.hasAttribute("download"))return;if(!(0,h.isLocalURL)(r)){n&&(t.preventDefault(),location.replace(r));return}if(t.preventDefault(),o){let e=!1;if(o({preventDefault:()=>{e=!0}}),e)return}let{dispatchNavigateAction:u}=e.r(99781);l.default.startTransition(()=>{u(s||r,n?"replace":"push",i??!0,a.current)})}}(t,D,B,j,L,S,A)},onMouseEnter(e){I||"function"!=typeof M||M(e),I&&a.props&&"function"==typeof a.props.onMouseEnter&&a.props.onMouseEnter(e),W&&U&&(0,m.onNavigationIntent)(e.currentTarget,!0===R)},onTouchStart:function(e){I||"function"!=typeof E||E(e),I&&a.props&&"function"==typeof a.props.onTouchStart&&a.props.onTouchStart(e),W&&U&&(0,m.onNavigationIntent)(e.currentTarget,!0===R)}};return(0,u.isAbsoluteUrl)(B)?F.href=B:I&&!k&&("a"!==a.type||"href"in a.props)||(F.href=(0,x.addBasePath)(B)),n=I?l.default.cloneElement(a,F):(0,i.jsx)("a",{...T,...F,children:s}),(0,i.jsx)(b.Provider,{value:o,children:n})}e.r(84508);let b=(0,l.createContext)(m.IDLE_LINK_STATUS),j=()=>(0,l.useContext)(b);("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},31713,e=>{"use strict";var t,r=e.i(43476),s=e.i(71645),a=((t={}).IDLE="IDLE",t.CAMERA="CAMERA",t.ANALYZING="ANALYZING",t.RESULT="RESULT",t.HISTORY="HISTORY",t.CRITICAL_SAMPLES="CRITICAL_SAMPLES",t);async function n(e,t,r="gemini-3-pro-preview"){try{let s=await fetch("/api/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({base64Image:e,additionalContext:t,modelName:r})}),a=await s.json().catch(()=>({}));if(!s.ok)throw Error(a?.message||"è¿žæŽ¥ AI æœåŠ¡å¤±è´¥");return a}catch(e){throw console.error("Gemini API Error:",e),Error(e.message||"è¿žæŽ¥ AI æœåŠ¡å¤±è´¥")}}let i=({label:e,value:t,unit:s,color:a,icon:n})=>(0,r.jsxs)("div",{className:"flex flex-col items-center p-3 rounded-2xl bg-white shadow-sm border border-gray-100",children:[(0,r.jsx)("div",{className:`p-2 rounded-full mb-2 ${a} text-white`,children:n}),(0,r.jsx)("span",{className:"text-xs text-gray-500 font-medium uppercase tracking-wider",children:e}),(0,r.jsxs)("div",{className:"flex items-baseline gap-1 mt-1",children:[(0,r.jsx)("span",{className:"text-xl font-bold text-gray-800",children:t.toFixed(1)}),(0,r.jsx)("span",{className:"text-xs text-gray-400 font-medium",children:s})]})]});var l=e.i(17927),o=e.i(22016);async function c(){let{data:e,error:t}=await l.supabase.auth.getUser();if(t)throw t;let r=e.user?.id;if(!r)throw Error("æœªç™»å½•");return r}async function d(e){try{let t=e.includes(",")?e.split(",")[1]:e,r=atob(t),s=Array(r.length);for(let e=0;e<r.length;e++)s[e]=r.charCodeAt(e);let a=new Uint8Array(s),n=new Blob([a],{type:"image/jpeg"}),i=`food_${Date.now()}.jpg`,{data:o,error:c}=await l.supabase.storage.from("food-images").upload(i,n,{contentType:"image/jpeg",upsert:!1});if(c)throw c;let{data:{publicUrl:d}}=l.supabase.storage.from("food-images").getPublicUrl(o.path);return d}catch(e){throw console.error("Error uploading image:",e),Error("å›¾ç‰‡ä¸Šä¼ äº‘ç«¯å¤±è´¥")}}async function u(e){let t=await c(),{data:r,error:s}=await l.supabase.from("meals").insert({user_id:t,timestamp:e.timestamp,description:e.description,insight:e.insight,image_url:e.imageUrl,global_scale:e.globalScale}).select().single();if(s)throw s;let a=e.items.map(e=>({user_id:t,meal_id:r.id,name:e.name,estimated_weight_grams:e.estimatedWeightGrams,original_weight_grams:e.originalWeightGrams,consumed_percentage:e.consumedPercentage,nutrients:e.nutrients})),{error:n}=await l.supabase.from("meal_items").insert(a);if(n)throw n;return r.id}async function x(){let e=await c(),{data:t,error:r}=await l.supabase.from("meals").select(`
      *,
      meal_items (*)
    `).eq("user_id",e).order("timestamp",{ascending:!1}).limit(50);if(r)throw r;return t.map(e=>({id:e.id,timestamp:e.timestamp,imageUrl:e.image_url,description:e.description,insight:e.insight,globalScale:e.global_scale,items:e.meal_items.map(e=>({id:e.id,name:e.name,estimatedWeightGrams:e.estimated_weight_grams,originalWeightGrams:e.original_weight_grams,consumedPercentage:e.consumed_percentage,nutrients:e.nutrients}))}))}async function m(e){let t=await c(),{data:r,error:s}=await l.supabase.from("staple_meals").insert({user_id:t,name:e.name,image_url:e.imageUrl,total_calories:e.totalCalories,items:e.items}).select().single();if(s)throw s;return{id:r.id,name:r.name,imageUrl:r.image_url,totalCalories:r.total_calories,items:r.items}}async function h(){let e=await c(),{data:t,error:r}=await l.supabase.from("staple_meals").select("*").eq("user_id",e).order("created_at",{ascending:!1});if(r)throw r;return t.map(e=>({id:e.id,name:e.name,imageUrl:e.image_url,totalCalories:e.total_calories,items:e.items}))}async function g(e){let t=await c(),{error:r}=await l.supabase.from("critical_samples").insert({user_id:t,timestamp:e.timestamp,food_name:e.foodName,image_url:e.imageUrl,ai_weight:e.aiWeight,user_weight:e.userWeight,deviation_percent:e.deviationPercent});if(r)throw r}async function p(e){let t=await c(),{error:r}=await l.supabase.from("meals").delete().eq("id",e).eq("user_id",t);if(r)throw r}async function f(e){let t=await c(),{error:r}=await l.supabase.from("critical_samples").delete().eq("id",e).eq("user_id",t);if(r)throw r}async function b(){let e=await c(),{data:t,error:r}=await l.supabase.from("critical_samples").select("*").eq("user_id",e).order("timestamp",{ascending:!1});if(r)throw r;return t.map(e=>({id:e.id,timestamp:e.timestamp,foodName:e.food_name,imageUrl:e.image_url,aiWeight:e.ai_weight,userWeight:e.user_weight,deviationPercent:e.deviation_percent}))}let j=window.SpeechRecognition||window.webkitSpeechRecognition,w=()=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-6 h-6",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"})]}),v=()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"})}),y=()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),N=()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"})}),k=()=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.362 5.214A8.252 8.252 0 0 1 12 21 8.25 8.25 0 0 1 6.038 7.047 8.287 8.287 0 0 0 9 9.601a8.983 8.983 0 0 1 3.361-6.867 8.21 8.21 0 0 0 3 2.48Z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18a3.75 3.75 0 0 0 .495-7.468 5.99 5.99 0 0 0-1.213 3.536 3.751 3.751 0 0 0 1.218 3.932Z"})]}),L=()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.362 5.214A8.252 8.252 0 0 1 12 21 8.25 8.25 0 0 1 6.038 7.047 8.287 8.287 0 0 0 9 9.601a8.983 8.983 0 0 1 3.361-6.867 8.21 8.21 0 0 0 3 2.48Z"})}),C=()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v18m0-18l-3 3m3-3l3 3m-9 6h12M9 12l3 3m-3-3l3-3m-3 9h6"})}),S=()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747c.224-.891.076-1.785-.417-2.46-.736-1.003-1.8-1.457-2.996-1.477l-1.042-.018c-1.291-.023-2.316-.902-2.316-2.195V4.75a.75.75 0 0 0-1.5 0v3.354c0 1.293-1.026 2.172-2.317 2.195l-1.042.018c-1.196.02-2.26.474-2.996 1.477-.493.675-.641 1.569-.417 2.46A9.004 9.004 0 0 0 12 21Z"})}),_=()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),M=()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})}),E=()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"})}),I=()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 0 0 6-6v-1.5m-6 7.5a6 6 0 0 1-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 0 1-3-3V4.5a3 3 0 1 1 6 0v8.25a3 3 0 0 1-3 3Z"})}),A=()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09-3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423l1.183.394-1.183.394a2.25 2.25 0 001.423 1.423l1.183.394-1.183.394a2.25 2.25 0 00-1.423 1.423z"})}),P=e=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:e.fill||"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-6 h-6",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"})}),R=()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"})}),T=()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})}),W=()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75"})}),U=()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 19.5v-15m0 0l-3.75 3.75M12 4.5l3.75 3.75M4.5 12l7.5-7.5 7.5 7.5M4.5 15l7.5 7.5 7.5-7.5"})}),O=()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-3 h-3",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12h-15"})}),D=()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-3 h-3",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),B=()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-6 h-6",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),$=()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),G=[{text:"å°è¯• 45 åº¦ä¿¯æ‹ä»¥èŽ·å¾—æœ€ä½³ä½“ç§¯ä¼°ç®—",icon:(0,r.jsx)(U,{})},{text:"ç¡®ä¿å…‰çº¿å……è¶³ï¼Œé¿å…é˜´å½±é®æŒ¡é£Ÿç‰©",icon:(0,r.jsx)(()=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M3 12h2.25m.386-6.364l1.591 1.591M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"})}),{})},{text:"åœ¨æ—è¾¹æ”¾ä¸€æŠŠå‹ºå­æˆ–æ‰‹ä½œä¸ºå¤§å°å‚è€ƒ",icon:(0,r.jsx)(A,{})},{text:"å°½é‡è®©æ‰€æœ‰é£Ÿç‰©éƒ½å¤„äºŽä¸­å¿ƒåŒºåŸŸ",icon:(0,r.jsx)(w,{})}],F=["åƒé¥­é¡ºåºæœ‰è®²ç©¶ï¼šå…ˆåƒè”¬èœï¼Œå†åƒè›‹ç™½è´¨ï¼Œæœ€åŽåƒç¢³æ°´ï¼Œå¯ä»¥æœ‰æ•ˆå¹³ç¨³è¡€ç³–ã€‚","æ¯ä¸€å£é£Ÿç‰©å’€åš¼ 20-30 æ¬¡ï¼Œä¸ä»…åŠ©æ¶ˆåŒ–ï¼Œè¿˜èƒ½æå‡é¥±è…¹æ„Ÿï¼Œå‡å°‘è¿‡é‡è¿›é£Ÿã€‚","é¤å‰ 30 åˆ†é’Ÿå–ä¸€æ¯æ°´ï¼Œå¯ä»¥æ¿€æ´»æ–°é™ˆä»£è°¢ï¼Œå¹¶è‡ªç„¶å‡å°‘æ­£é¤æ‘„å…¥é‡ã€‚","æ—©é¤æ‘„å…¥ 30g è›‹ç™½è´¨ï¼ˆå¦‚é¸¡è›‹ã€ç‰›å¥¶ï¼‰ï¼Œå¯ä»¥é˜²æ­¢åˆé¤å‰çš„é¥¥é¥¿æ„Ÿå’Œå¯¹ç”œé£Ÿçš„æ¸´æœ›ã€‚","å†·æŽ‰çš„ç±³é¥­æˆ–åœŸè±†å«æœ‰æ›´å¤š'æŠ—æ€§æ·€ç²‰'ï¼Œçƒ­é‡å¸æ”¶ä¼šæ¯”çƒ­ç€åƒå‡å°‘å¾ˆå¤šã€‚","æ·±è‰²è”¬èœï¼ˆå¦‚è èœã€ç´«ç”˜è“ï¼‰é€šå¸¸æ¯”æµ…è‰²è”¬èœå«æœ‰æ›´å¤šçš„æŠ—æ°§åŒ–å‰‚å’Œå¾®é‡å…ƒç´ ã€‚","è¿›é£Ÿé«˜ç¢³æ°´é£Ÿç‰©å‰å–ä¸€ç‚¹é†‹æˆ–æŸ æª¬æ°´ï¼Œæœ‰åŠ©äºŽé™ä½Žèƒ°å²›ç´ ååº”ï¼Œå‡å°‘è„‚è‚ªå †ç§¯ã€‚","å°½é‡åœ¨ç¡å‰ 3 å°æ—¶åœæ­¢è¿›é£Ÿï¼Œè®©è‚ èƒƒæœ‰å……åˆ†çš„æ—¶é—´ä¼‘æ¯å’Œä¿®å¤ã€‚"];function z(){let[e,t]=(0,s.useState)(null),[c,z]=(0,s.useState)(!1),[Z,q]=(0,s.useState)(!1),[Y,H]=(0,s.useState)("login"),[V,K]=(0,s.useState)(""),[J,Q]=(0,s.useState)(""),[X,ee]=(0,s.useState)(!1),[et,er]=(0,s.useState)(null),[es,ea]=(0,s.useState)(a.IDLE),[en,ei]=(0,s.useState)([]),[el,eo]=(0,s.useState)([]),[ec,ed]=(0,s.useState)([]),[eu,ex]=(0,s.useState)(null),[em,eh]=(0,s.useState)(null),[eg,ep]=(0,s.useState)(!1),[ef,eb]=(0,s.useState)(!1),[ej,ew]=(0,s.useState)(""),[ev,ey]=(0,s.useState)(null),[eN,ek]=(0,s.useState)(!1),[eL,eC]=(0,s.useState)(0),[eS,e_]=(0,s.useState)(0),[eM,eE]=(0,s.useState)(!1),[eI,eA]=(0,s.useState)(""),[eP,eR]=(0,s.useState)(!1),[eT,eW]=(0,s.useState)(0),[eU,eO]=(0,s.useState)(""),[eD,eB]=(0,s.useState)(!1),[e$,eG]=(0,s.useState)(null),eF=(0,s.useRef)(null),ez=(0,s.useRef)(null),eZ=(0,s.useRef)(null),[eq,eY]=(0,s.useState)(null);(0,s.useEffect)(()=>{l.supabase.auth.getSession().then(({data:{session:e}})=>{t(e?.user??null)});let{data:{subscription:e}}=l.supabase.auth.onAuthStateChange((e,r)=>{t(r?.user??null)});return()=>e.unsubscribe()},[]),(0,s.useEffect)(()=>{!async function(){if(!e)return z(!1);try{let{data:t,error:r}=await l.supabase.from("eval_admins").select("role").eq("user_id",e.id).maybeSingle();if(r)throw r;z(!!t)}catch{z(!1)}}()},[e]),(0,s.useEffect)(()=>{!async function(){if(!e){ei([]),eo([]),ed([]);return}try{let[e,t,r]=await Promise.all([x(),h(),b()]);ei(e),eo(t),ed(r)}catch(t){console.error("Failed to load data from Supabase",t);let e=localStorage.getItem("nutrilens_history_v4");e&&ei(JSON.parse(e))}}()},[e]),(0,s.useEffect)(()=>{let e;return es===a.ANALYZING&&(e=setInterval(()=>{e_(e=>(e+1)%F.length)},3e3)),()=>clearInterval(e)},[es]);let eH=(e,t,r)=>{try{localStorage.setItem(e,JSON.stringify(t)),r(t)}catch(s){("QuotaExceededError"===s.name||22===s.code)&&(Array.isArray(t)&&t.length>1?eH(e,t.slice(0,Math.floor(.8*t.length)),r):eY("æ‰‹æœºå­˜å‚¨ç©ºé—´å·²æ»¡ï¼Œæ— æ³•ä¿å­˜æ–°è®°å½•ï¼Œè¯·æ¸…ç†åŽ†å²æ•°æ®ã€‚"))}},eV=async e=>{e.preventDefault(),ee(!0),er(null);try{if("login"===Y){let{error:e}=await l.supabase.auth.signInWithPassword({email:V,password:J});if(e)throw e}else{let{error:e}=await l.supabase.auth.signUp({email:V,password:J});if(e)throw e;alert("æ³¨å†ŒæˆåŠŸï¼Œè¯·æ£€æŸ¥é‚®ç®±è¿›è¡ŒéªŒè¯ï¼ˆå¦‚æžœå¼€å¯äº†é‚®ç®±éªŒè¯ï¼‰æˆ–ç›´æŽ¥ç™»å½•ã€‚")}q(!1),K(""),Q("")}catch(e){er(e.message||"æ“ä½œå¤±è´¥")}finally{ee(!1)}},eK=async()=>{confirm("ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ")&&await l.supabase.auth.signOut()},eJ=async t=>{if(!e){let e={...t};return ei(t=>[e,...t].slice(0,10)),e}try{let e=await u(t),r={...t,id:e};return ei(e=>[r,...e].slice(0,50)),r}catch(e){return console.error("Failed to save to Supabase",e),eH("nutrilens_history_v4",[t,...en].slice(0,50),ei),t}},eQ=async t=>{if(eD)return;if(!e){eG("è¯·å…ˆç™»å½•ä»¥ä¿å­˜åå·®æ ·æœ¬åˆ°äº‘ç«¯ã€‚"),setTimeout(()=>eG(null),3500);return}let r=[];if(t.items.forEach(e=>{if(e.originalWeightGrams&&e.originalWeightGrams>0){let s=e.estimatedWeightGrams-e.originalWeightGrams,a=s/e.originalWeightGrams;Math.abs(s)>1&&r.push({id:Date.now()+Math.random().toString(),timestamp:Date.now(),imageUrl:t.imageUrl,foodName:e.name,aiWeight:e.originalWeightGrams,userWeight:e.estimatedWeightGrams,deviationPercent:Math.round(100*a)})}}),r.length>0)try{await Promise.all(r.map(e=>g(e)));let e=[...r,...ec].slice(0,50);ed(e),eO(`å·²æ‰‹åŠ¨å½’æ¡£ ${r.length} ä¸ªåå·®æ ·æœ¬`),eW(r.length),setTimeout(()=>eW(0),4e3),eB(!0),eG(null)}catch(e){console.error("Failed to save critical samples to Supabase",e),eH("nutrilens_critical_samples_v1",[...r,...ec].slice(0,50),ed)}else eG("è¯·å…ˆä¿®æ”¹ä¸Šæ–¹çš„é‡é‡æ•°å€¼ï¼Œä»¥ä¾¿æˆ‘ä»¬è®°å½•åå·®ã€‚"),setTimeout(()=>eG(null),3500)},eX=async()=>{eu&&await eQ(eu)},e0=async(e,t)=>{if(e.stopPropagation(),confirm("ç¡®å®šè¦åˆ é™¤è¿™æ¡è®°å½•å—ï¼Ÿ"))try{await p(t),ei(e=>e.filter(e=>e.id!==t))}catch(e){console.error("Failed to delete meal",e),alert("åˆ é™¤å¤±è´¥")}},e1=async(e,t)=>{if(e.stopPropagation(),confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªåå·®æ ·æœ¬å—ï¼Ÿ"))try{await f(t),ed(e=>e.filter(e=>e.id!==t))}catch(e){console.error("Failed to delete critical sample",e),alert("åˆ é™¤å¤±è´¥")}},e2=async()=>{if(!eu||!eI.trim())return;if(!e){alert("è¯·å…ˆç™»å½•åŽå†ä¿å­˜å¸¸é¤æ¨¡ç‰ˆ"),q(!0);return}let t={name:eI.trim(),imageUrl:eu.imageUrl,items:eu.items.map(({id:e,...t})=>t),totalCalories:eu.items.reduce((e,t)=>e+(t.nutrients?.calories||0)*(t.consumedPercentage/100),0)};try{let e=await m(t);eo(t=>[e,...t].slice(0,20)),eE(!1),eA(""),eR(!0),setTimeout(()=>eR(!1),3e3)}catch(e){console.error("Failed to save staple to Supabase",e),eH("nutrilens_staples_v1",[{...t,id:Date.now().toString()},...el].slice(0,20),eo)}},e5=async e=>{let t={id:Date.now().toString(),timestamp:Date.now(),imageUrl:e.imageUrl,description:`å¿«é€Ÿå¤ç”¨: ${e.name}`,insight:`å·²å¿«é€Ÿå¤ç”¨å¸¸é¤â€œ${e.name}â€ã€‚æ•°æ®å·²æ ¹æ®æ‚¨çš„æ¨¡ç‰ˆè‡ªåŠ¨å¡«å……ã€‚`,globalScale:100,items:e.items.map((e,t)=>({...e,id:`item-${t}-${Date.now()}`,consumedPercentage:100}))};ex(t),await eJ(t),ea(a.RESULT)},e3=async()=>{ta()},e4=async()=>{try{eY(null),ea(a.CAMERA);let e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});eF.current&&(eF.current.srcObject=e)}catch(e){eY("æ— æ³•è®¿é—®æ‘„åƒå¤´"),ea(a.IDLE)}},e6=()=>{eF.current?.srcObject&&eF.current.srcObject.getTracks().forEach(e=>e.stop())},e7=async()=>{if(!eF.current||!ez.current)return;let e=ez.current;e.width=800,e.height=eF.current.videoHeight/eF.current.videoWidth*800,e.getContext("2d")?.drawImage(eF.current,0,0,e.width,e.height);let t=e.toDataURL("image/jpeg",.6);e6(),e9(t)},e8=async e=>{let t=e.target.files?.[0];if(t){let e=new FileReader;e.onload=async e=>{e9(await ((e,t=800,r=.6)=>new Promise(s=>{let a=new Image;a.src=e,a.onload=()=>{let e=document.createElement("canvas"),n=a.width,i=a.height;n>t&&(i=Math.round(i*t/n),n=t),e.width=n,e.height=i;let l=e.getContext("2d");l?.drawImage(a,0,0,n,i),s(e.toDataURL("image/jpeg",r))},a.onerror=()=>s(e)}))(e.target?.result))},e.readAsDataURL(t)}},e9=e=>{ey(e),eb(!0),ea(a.IDLE),eB(!1),eG(null)},te=async()=>{if(ev){ep(!0),eb(!1),ea(a.ANALYZING);try{let t=ev;if(e)try{t=await d(ev)}catch(e){console.warn("Upload failed, using local URL:",e)}let r=await n(ev,ej,"gemini-2.0-flash"),s={id:Date.now().toString(),timestamp:Date.now(),imageUrl:t,description:r.description,insight:r.insight,globalScale:100,items:r.items.map((e,t)=>({...e,id:`item-${t}-${Date.now()}`,consumedPercentage:100}))},i=await eJ(s);ex(i),ea(a.RESULT)}catch(e){eY(e.message||"åˆ†æžå¤±è´¥"),ea(a.IDLE)}finally{ep(!1),ew(""),ey(null)}}},tt=(e,t)=>{!eu||isNaN(t)||ex({...eu,items:eu.items.map(r=>r.id===e?{...r,estimatedWeightGrams:t}:r)})},tr=(e,t)=>{if(!eu)return;let r=eu.items.find(t=>t.id===e);r&&tt(e,Math.max(1,Math.round(r.estimatedWeightGrams*t)))},ts=(0,s.useMemo)(()=>eu?eu.items.reduce((e,t)=>{let r=(t.consumedPercentage||0)/100,s=t.nutrients||{};return{calories:e.calories+(s.calories||0)*r,protein:e.protein+(s.protein||0)*r,carbs:e.carbs+(s.carbs||0)*r,fat:e.fat+(s.fat||0)*r,fiber:e.fiber+(s.fiber||0)*r,sugar:e.sugar+(s.sugar||0)*r,weight:e.weight+(t.estimatedWeightGrams||0)*r}},{calories:0,protein:0,carbs:0,fat:0,fiber:0,sugar:0,weight:0}):{calories:0,protein:0,carbs:0,fat:0,fiber:0,sugar:0,weight:0},[eu]),ta=()=>{e6(),ex(null),ea(a.IDLE),eb(!1),eE(!1),eY(null),eh(null),eB(!1),eG(null)};return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 text-gray-900 pb-20",children:[(0,r.jsx)("input",{type:"file",ref:eZ,onChange:e8,accept:"image/*",className:"hidden"}),(0,r.jsxs)("header",{className:"fixed top-0 inset-x-0 bg-white/80 backdrop-blur-md z-40 px-6 py-4 flex items-center justify-between border-b border-gray-100 shadow-sm",children:[(0,r.jsx)("h1",{className:"text-xl font-extrabold bg-gradient-to-r from-green-600 to-emerald-500 bg-clip-text text-transparent",children:"NutriLens æ™ºèƒ½é£ŸæŽ¢"}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(es!==a.IDLE||ef)&&(0,r.jsx)("button",{onClick:ta,className:"text-gray-400 hover:text-gray-600 p-2",children:(0,r.jsx)(_,{})}),e?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[c&&(0,r.jsx)(o.default,{href:"/admin",className:"text-xs font-bold px-3 py-1.5 rounded-full border border-gray-200 text-gray-700 hover:bg-gray-50",title:"è¯„æµ‹åŽå°",children:"è¯„æµ‹åŽå°"}),(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-green-100 text-green-600 flex items-center justify-center",children:(0,r.jsx)(T,{})}),(0,r.jsx)("button",{onClick:eK,className:"text-gray-400 hover:text-red-500 p-2",title:"é€€å‡ºç™»å½•",children:(0,r.jsx)(W,{})})]}):(0,r.jsx)("button",{onClick:()=>q(!0),className:"px-4 py-1.5 rounded-full bg-gray-900 text-white text-xs font-bold hover:bg-gray-800 transition-colors",children:"ç™»å½•/æ³¨å†Œ"})]})]}),eT>0&&(0,r.jsxs)("div",{className:"fixed top-20 left-1/2 -translate-x-1/2 z-50 bg-red-500 text-white px-6 py-3 rounded-full shadow-xl flex items-center gap-2 animate-in slide-in-from-top-4 whitespace-nowrap",children:[(0,r.jsx)(B,{}),(0,r.jsx)("span",{className:"text-sm font-bold",children:eU})]}),(0,r.jsxs)("main",{className:"pt-24 px-4 max-w-lg mx-auto",children:[es===a.IDLE&&!ef&&(0,r.jsxs)("div",{className:"space-y-8 py-6 animate-in fade-in",children:[eq&&(0,r.jsxs)("div",{className:"bg-red-50 border border-red-100 text-red-500 px-4 py-3 rounded-2xl flex items-center gap-3 text-sm font-bold animate-in slide-in-from-top-2",children:[(0,r.jsx)(B,{}),eq]}),(0,r.jsxs)("div",{className:"text-center space-y-2",children:[(0,r.jsx)("h2",{className:"text-4xl font-black text-gray-800 tracking-tight",children:"æ™ºèƒ½è¯†é¤ã€‚"}),(0,r.jsx)("p",{className:"text-gray-500 font-medium px-4",children:"å£è¢‹é‡Œçš„ AI é£Ÿç‰©ç§¤ï¼Œç²¾å‡†åˆ†æžæ¯ä¸€å£è¥å…»ã€‚"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[(0,r.jsxs)("button",{onClick:e4,className:"w-full bg-green-600 text-white rounded-[2.5rem] p-8 flex flex-col items-center gap-3 shadow-2xl shadow-green-100 transition-transform active:scale-95 group relative overflow-hidden",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-white/10 opacity-0 group-hover:opacity-100 transition-opacity"}),(0,r.jsx)("div",{className:"p-4 bg-white/20 rounded-full",children:(0,r.jsx)(w,{})}),(0,r.jsx)("span",{className:"text-xl font-bold",children:"ç«‹å³æ‹ç…§è¯†åˆ«"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-1",children:[(0,r.jsxs)("h3",{className:"text-xs font-black text-gray-400 uppercase tracking-widest flex items-center gap-2",children:["æˆ‘çš„å¸¸ç”¨é¤é£Ÿ ",(0,r.jsx)(P,{fill:"currentColor"})]}),el.length>0&&(0,r.jsx)("span",{className:"text-[10px] text-green-600 font-bold",children:"å·¦å³æ»‘åŠ¨å¿«é€Ÿè®°å½•"})]}),(0,r.jsx)("div",{className:"flex gap-4 overflow-x-auto pb-4 no-scrollbar -mx-4 px-4",children:e?el.length>0?el.map(e=>(0,r.jsx)("button",{onClick:()=>e5(e),className:"flex-shrink-0 w-28 space-y-2 text-left group",children:(0,r.jsxs)("div",{className:"relative aspect-square rounded-[1.5rem] overflow-hidden border-2 border-transparent group-hover:border-green-500 shadow-sm transition-all group-active:scale-90",children:[(0,r.jsx)("img",{src:e.imageUrl,className:"w-full h-full object-cover"}),(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"}),(0,r.jsx)("div",{className:"absolute bottom-2 left-2 right-2 text-[10px] font-black text-white truncate",children:e.name})]})},e.id)):(0,r.jsxs)("div",{className:"w-full bg-gray-100/50 border-2 border-dashed border-gray-200 rounded-[2rem] p-6 flex flex-col items-center justify-center text-center space-y-2 text-gray-400 italic",children:[(0,r.jsx)("div",{className:"p-3 bg-white rounded-full text-gray-300",children:(0,r.jsx)(P,{})}),(0,r.jsxs)("p",{className:"text-xs font-medium",children:["è¯†åˆ«åŽç‚¹å‡»çˆ±å¿ƒä¿å­˜å¸¸é¤",(0,r.jsx)("br",{}),"ä¸‹æ¬¡åƒé¥­ä¸€é”®å¤ç”¨ï¼Œæ— éœ€é‡æ‹"]})]}):(0,r.jsxs)("div",{className:"w-full bg-blue-50/50 border-2 border-dashed border-blue-200 rounded-[2rem] p-6 flex flex-col items-center justify-center text-center space-y-2 text-blue-400",children:[(0,r.jsx)("div",{className:"p-3 bg-white rounded-full text-blue-300",children:(0,r.jsx)(T,{})}),(0,r.jsxs)("p",{className:"text-xs font-bold",children:["ç™»å½•åŽå¼€å¯äº‘ç«¯å¸¸é¤æ¨¡ç‰ˆ",(0,r.jsx)("br",{}),"å¤šç«¯åŒæ­¥ï¼Œæ°¸ä¸ä¸¢å¤±"]}),(0,r.jsx)("button",{onClick:()=>q(!0),className:"text-[10px] bg-blue-600 text-white px-4 py-1.5 rounded-full font-black",children:"ç«‹å³ç™»å½•"})]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("button",{onClick:()=>eZ.current?.click(),className:"bg-white border border-gray-100 rounded-[1.5rem] p-4 flex flex-col items-center gap-2 shadow-sm active:scale-95 transition-transform",children:[(0,r.jsx)("div",{className:"p-2 bg-gray-50 rounded-full text-gray-400",children:(0,r.jsx)(v,{})}),(0,r.jsx)("span",{className:"text-xs font-bold text-gray-600",children:"ä»Žç›¸å†Œä¸Šä¼ "})]}),(0,r.jsxs)("button",{onClick:()=>ea(a.HISTORY),className:"bg-white border border-gray-100 rounded-[1.5rem] p-4 flex flex-col items-center gap-2 shadow-sm active:scale-95 transition-transform",children:[(0,r.jsx)("div",{className:"p-2 bg-gray-50 rounded-full text-gray-400",children:(0,r.jsx)(y,{})}),(0,r.jsx)("span",{className:"text-xs font-bold text-gray-600",children:"æŸ¥çœ‹åŽ†å²"})]})]})]})]}),ef&&ev&&(0,r.jsxs)("div",{className:"animate-in slide-in-from-bottom-10 space-y-6 pb-32",children:[(0,r.jsx)("div",{className:"relative rounded-3xl overflow-hidden shadow-xl",children:(0,r.jsx)("img",{src:ev,className:"w-full aspect-video object-cover"})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"p-2 bg-blue-100 text-blue-600 rounded-lg",children:(0,r.jsx)(A,{})}),(0,r.jsx)("h3",{className:"text-xl font-black text-gray-800",children:"è¡¥å……ç»†èŠ‚"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-500 leading-relaxed",children:"æä¾›æ›´å¤šä¸Šä¸‹æ–‡èƒ½æ˜¾è‘—æé«˜è¯†åˆ«å‡†ç¡®çŽ‡ï¼ˆå¦‚ï¼šè¿™æ˜¯æˆ‘çš„ 500ml æ ‡å‡†ä¾¿å½“ç›’ï¼‰ã€‚"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("textarea",{value:ej,onChange:e=>ew(e.target.value),placeholder:"ä¾‹å¦‚ï¼šè¿™æ˜¯å­¦æ ¡é£Ÿå ‚çš„å¤§ä»½ï¼Œæˆ–è€…é¢å¤–åŠ äº†è¾£æ²¹...",className:"w-full bg-white border border-gray-200 rounded-2xl p-4 pr-12 min-h-[120px] text-gray-700 focus:ring-2 focus:ring-green-500 outline-none transition-shadow text-base"}),(0,r.jsx)("button",{onClick:()=>{if(!j)return alert("ä¸æ”¯æŒè¯­éŸ³è¯†åˆ«");let e=new j;e.lang="zh-CN",e.onstart=()=>ek(!0),e.onend=()=>ek(!1),e.onresult=e=>ew(t=>(t?t+" ":"")+e.results[0][0].transcript),e.start()},className:`absolute right-3 bottom-3 p-3 rounded-full transition-all ${eN?"bg-red-500 text-white animate-pulse shadow-lg shadow-red-100":"bg-gray-50 text-gray-400 hover:text-green-600"}`,children:(0,r.jsx)(I,{})})]}),(0,r.jsx)("button",{onClick:te,className:"w-full bg-gray-900 text-white rounded-2xl py-5 font-bold shadow-2xl active:scale-95 transition-all text-lg",children:eg?"æ­£åœ¨æ·±åº¦åˆ†æž...":"ç¡®è®¤å¹¶å¼€å§‹åˆ†æž"})]})]}),es===a.CAMERA&&(0,r.jsxs)("div",{className:"fixed inset-0 bg-black z-50 flex flex-col",children:[(0,r.jsx)("video",{ref:eF,autoPlay:!0,playsInline:!0,className:"flex-1 object-cover"}),(0,r.jsx)("div",{className:"absolute inset-0 pointer-events-none flex items-center justify-center",children:(0,r.jsxs)("div",{className:"w-72 h-72 border-2 border-white/20 rounded-[3rem] relative",children:[(0,r.jsx)("div",{className:"absolute -top-1 -left-1 w-10 h-10 border-t-4 border-l-4 border-green-500 rounded-tl-[1.5rem]"}),(0,r.jsx)("div",{className:"absolute -top-1 -right-1 w-10 h-10 border-t-4 border-r-4 border-green-500 rounded-tr-[1.5rem]"}),(0,r.jsx)("div",{className:"absolute -bottom-1 -left-1 w-10 h-10 border-b-4 border-l-4 border-green-500 rounded-bl-[1.5rem]"}),(0,r.jsx)("div",{className:"absolute -bottom-1 -right-1 w-10 h-10 border-b-4 border-r-4 border-green-500 rounded-br-[1.5rem]"})]})}),(0,r.jsx)("div",{className:"absolute top-20 inset-x-4",children:(0,r.jsxs)("div",{className:"bg-black/40 backdrop-blur-md border border-white/10 rounded-2xl p-4 flex items-center gap-3 text-white",children:[(0,r.jsx)("div",{className:"text-green-400 shrink-0",children:G[eL].icon}),(0,r.jsx)("p",{className:"text-sm font-medium",children:G[eL].text})]})}),(0,r.jsxs)("div",{className:"absolute bottom-12 inset-x-0 flex items-center justify-center gap-8 px-10",children:[(0,r.jsx)("button",{onClick:ta,className:"p-4 bg-white/10 backdrop-blur-md rounded-full text-white active:scale-90 transition-transform",children:(0,r.jsx)(N,{})}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("button",{onClick:e7,className:"w-20 h-20 bg-white rounded-full border-8 border-white/30 active:scale-90 transition-transform flex items-center justify-center relative z-10"}),(0,r.jsx)("div",{className:"absolute -inset-2 bg-green-500/20 rounded-full animate-ping pointer-events-none"})]}),(0,r.jsx)("button",{onClick:()=>eZ.current?.click(),className:"p-4 bg-white/10 backdrop-blur-md rounded-full text-white active:scale-90 transition-transform",children:(0,r.jsx)(v,{})})]})]}),es===a.ANALYZING&&(0,r.jsxs)("div",{className:"fixed inset-0 bg-white z-50 flex flex-col items-center justify-center text-center p-8 space-y-6",children:[(0,r.jsxs)("div",{className:"w-24 h-24 relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 border-4 border-green-100 rounded-full"}),(0,r.jsx)("div",{className:"absolute inset-0 border-4 border-green-600 rounded-full border-t-transparent animate-spin"}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-green-600",children:(0,r.jsx)(A,{})})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"text-2xl font-black text-gray-800 tracking-tight",children:"AI è§†è§‰æ‰«æä¸­..."}),(0,r.jsx)("p",{className:"text-green-600 text-[10px] font-black uppercase tracking-[0.2em] mb-4",children:"æ­£åœ¨æ™ºèƒ½åˆ†æžæ‚¨çš„é¤é£Ÿ"}),(0,r.jsxs)("div",{className:"bg-green-50/50 p-4 rounded-2xl max-w-[280px] mx-auto animate-in fade-in slide-in-from-bottom-2",children:[(0,r.jsx)("p",{className:"text-green-800 text-xs font-bold mb-1",children:"ðŸ’¡ å¥åº·å†·çŸ¥è¯†"}),(0,r.jsx)("p",{className:"text-green-600 text-sm font-medium leading-relaxed",children:F[eS]})]})]})]}),es===a.RESULT&&eu&&(0,r.jsxs)("div",{className:"animate-in slide-in-from-bottom-10 space-y-8 pb-32",children:[(0,r.jsxs)("div",{className:"relative rounded-[2.5rem] overflow-hidden shadow-2xl border border-white",children:[(0,r.jsx)("img",{src:eu.imageUrl,className:"w-full aspect-square object-cover"}),(0,r.jsxs)("div",{className:"absolute bottom-4 left-4 right-4 bg-white/90 backdrop-blur-md p-4 rounded-[1.5rem] shadow-lg border border-white/50",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[(0,r.jsx)(A,{}),(0,r.jsx)("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"AI å¥åº·é€è§†"})]}),(0,r.jsxs)("p",{className:"text-xs text-gray-700 font-semibold leading-relaxed",children:['"',eu.insight,'"']})]}),(0,r.jsx)("button",{onClick:()=>eE(!0),className:`absolute top-4 right-4 p-4 rounded-full backdrop-blur-md transition-all transform hover:scale-110 active:scale-90 shadow-lg ${eP?"bg-green-500 text-white":"bg-black/30 text-white"}`,children:eP?(0,r.jsx)(R,{}):(0,r.jsx)(P,{fill:el.some(e=>e.imageUrl===eu.imageUrl)?"currentColor":"none"})})]}),eP&&(0,r.jsxs)("div",{className:"bg-green-600 text-white px-5 py-4 rounded-2xl text-xs font-black animate-in slide-in-from-top-4 flex items-center gap-3 shadow-xl shadow-green-100",children:[(0,r.jsx)(R,{})," å·²æˆåŠŸä¿å­˜åˆ°å¸¸é¤æ¨¡ç‰ˆï¼Œä¸‹æ¬¡å¯åœ¨é¦–é¡µå¿«é€Ÿå¤ç”¨ã€‚"]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-1",children:[(0,r.jsx)("h2",{className:"text-2xl font-black text-gray-800 tracking-tight",children:"è¥å…»ç»Ÿè®¡"}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("span",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1",children:"æ€»é¢„ä¼°é‡é‡"}),(0,r.jsxs)("div",{className:"flex items-center gap-2 bg-green-50 px-4 py-1.5 rounded-full border border-green-100",children:[(0,r.jsx)("input",{type:"number",value:Math.round(ts.weight),onChange:e=>(e=>{if(!eu||isNaN(e)||e<=0)return;let t=eu.items.reduce((e,t)=>e+t.estimatedWeightGrams,0);if(0===t)return;let r=e/t;ex({...eu,items:eu.items.map(e=>({...e,estimatedWeightGrams:Math.round(e.estimatedWeightGrams*r)}))})})(parseInt(e.target.value)),className:"bg-transparent text-lg font-black text-green-600 w-16 text-right focus:outline-none border-none p-0"}),(0,r.jsx)("span",{className:"text-green-600 font-bold text-sm",children:"å…‹"}),(0,r.jsx)("div",{className:"text-green-300 ml-1",children:(0,r.jsx)(U,{})})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)(i,{label:"çƒ­é‡",value:ts.calories,unit:"kcal",color:"bg-orange-500",icon:(0,r.jsx)(k,{})}),(0,r.jsx)(i,{label:"è›‹ç™½è´¨",value:ts.protein,unit:"g",color:"bg-blue-600",icon:(0,r.jsx)(L,{})}),(0,r.jsx)(i,{label:"æ€»ç¢³æ°´",value:ts.carbs,unit:"g",color:"bg-yellow-500",icon:(0,r.jsx)(C,{})}),(0,r.jsx)(i,{label:"æ€»è„‚è‚ª",value:ts.fat,unit:"g",color:"bg-red-500",icon:(0,r.jsx)(S,{})})]}),(0,r.jsxs)("div",{className:"space-y-4 pt-4",children:[(0,r.jsxs)("h3",{className:"text-xs font-black text-gray-400 uppercase tracking-widest px-1",children:["åŒ…å«æˆåˆ† (",eu.items.length,")"]}),(0,r.jsx)("div",{className:"space-y-3",children:eu.items.map(e=>{let t=em===e.id,s=e.consumedPercentage/100,a=e.nutrients||{calories:0,protein:0,carbs:0,fat:0,fiber:0};return(0,r.jsxs)("div",{className:"bg-white overflow-hidden rounded-[1.5rem] border border-gray-100 shadow-sm transition-all duration-300",children:[(0,r.jsxs)("div",{className:"p-5 space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1 pr-4",children:[(0,r.jsx)("input",{value:e.name,onChange:t=>{var r,s;return r=e.id,s=t.target.value,void(eu&&ex({...eu,items:eu.items.map(e=>e.id===r?{...e,name:s}:e)}))},className:"font-black text-gray-800 leading-tight bg-transparent border-none focus:ring-0 p-0 w-full text-base"}),(0,r.jsxs)("div",{className:"flex items-center gap-3 mt-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 px-2 py-1 rounded-lg bg-gray-50 border border-gray-100 focus-within:border-green-300 focus-within:ring-2 focus-within:ring-green-100 transition-all",children:[(0,r.jsx)("input",{type:"number",value:Math.round(e.estimatedWeightGrams),onChange:t=>tt(e.id,parseInt(t.target.value)),className:"w-10 bg-transparent font-bold text-gray-600 focus:outline-none border-none p-0 text-center"}),(0,r.jsx)("span",{className:"text-gray-400 font-medium text-xs",children:"g"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("button",{onClick:()=>tr(e.id,.9),className:"p-1.5 rounded-full bg-red-50 text-red-500 hover:bg-red-100 active:scale-90 transition-all",children:(0,r.jsx)(O,{})}),(0,r.jsx)("button",{onClick:()=>tr(e.id,1.1),className:"p-1.5 rounded-full bg-green-50 text-green-600 hover:bg-green-100 active:scale-90 transition-all",children:(0,r.jsx)(D,{})})]}),(0,r.jsx)("span",{className:"text-[10px] text-gray-300",children:"|"}),(0,r.jsxs)("span",{className:"text-xs text-gray-400",children:["æ‘„å…¥: ",(0,r.jsxs)("strong",{className:"text-gray-700",children:[Math.round(e.estimatedWeightGrams*s),"g"]})]})]})]}),(0,r.jsxs)("div",{className:"text-right flex flex-col items-end",children:[(0,r.jsxs)("span",{className:"block text-green-600 font-black whitespace-nowrap",children:[Math.round((a.calories||0)*s)," kcal"]}),(0,r.jsx)("button",{onClick:()=>eh(t?null:e.id),className:"text-gray-300 hover:text-gray-500 p-1",children:t?(0,r.jsx)(E,{}):(0,r.jsx)(M,{})})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-[10px] font-black text-gray-400 uppercase",children:[(0,r.jsx)("span",{children:"æ‘„å…¥æ¯”ä¾‹"}),(0,r.jsxs)("span",{children:[e.consumedPercentage,"%"]})]}),(0,r.jsx)("input",{type:"range",min:"0",max:"100",value:e.consumedPercentage,onChange:t=>((e,t)=>{if(!eu)return;let r=eu.items.map(r=>r.id===e?{...r,consumedPercentage:t}:r),s=r.reduce((e,t)=>e+t.estimatedWeightGrams,0),a=r.reduce((e,t)=>e+t.estimatedWeightGrams*(t.consumedPercentage/100),0);ex({...eu,items:r,globalScale:s>0?Math.round(a/s*100):t})})(e.id,parseInt(t.target.value)),className:"w-full h-2 bg-gray-50 rounded-lg appearance-none cursor-pointer accent-green-500"})]})]}),t&&(0,r.jsx)("div",{className:"px-5 pb-5 pt-0 animate-in fade-in slide-in-from-top-1",children:(0,r.jsxs)("div",{className:"border-t border-gray-50 pt-4 grid grid-cols-2 gap-2",children:[(0,r.jsxs)("div",{className:"bg-gray-50/50 p-2 rounded-xl flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-[10px] font-bold text-gray-400",children:"è›‹ç™½è´¨"}),(0,r.jsxs)("span",{className:"text-xs font-black",children:[((a.protein||0)*s).toFixed(1),"g"]})]}),(0,r.jsxs)("div",{className:"bg-gray-50/50 p-2 rounded-xl flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-[10px] font-bold text-gray-400",children:"ç¢³æ°´"}),(0,r.jsxs)("span",{className:"text-xs font-black",children:[((a.carbs||0)*s).toFixed(1),"g"]})]}),(0,r.jsxs)("div",{className:"bg-gray-50/50 p-2 rounded-xl flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-[10px] font-bold text-gray-400",children:"è„‚è‚ª"}),(0,r.jsxs)("span",{className:"text-xs font-black",children:[((a.fat||0)*s).toFixed(1),"g"]})]}),(0,r.jsxs)("div",{className:"bg-gray-50/50 p-2 rounded-xl flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-[10px] font-bold text-gray-400",children:"çº¤ç»´"}),(0,r.jsxs)("span",{className:"text-xs font-black",children:[((a.fiber||0)*s).toFixed(1),"g"]})]})]})})]},e.id)})})]}),(0,r.jsxs)("div",{className:"space-y-3 mt-4",children:[(0,r.jsx)("button",{onClick:e3,className:"w-full bg-gray-900 text-white rounded-[1.5rem] py-5 font-black shadow-xl active:scale-95 transition-all text-lg",children:"ç¡®è®¤è®°å½•å¹¶å®Œæˆ"}),(0,r.jsxs)("div",{className:"relative",children:[e$&&(0,r.jsx)("div",{className:"absolute bottom-full left-0 right-0 mb-2 text-center animate-in slide-in-from-bottom-2 fade-in",children:(0,r.jsxs)("span",{className:"inline-block bg-red-600 text-white text-[10px] font-bold px-3 py-1.5 rounded-lg shadow-lg relative",children:[e$,(0,r.jsx)("div",{className:"absolute top-full left-1/2 -translate-x-1/2 border-4 border-transparent border-t-red-600"})]})}),(0,r.jsx)("button",{onClick:eX,disabled:eD,className:`w-full py-3 text-xs font-bold flex items-center justify-center gap-1 transition-all active:scale-95 ${eD?"text-green-500 bg-green-50 rounded-xl cursor-default":"text-red-400 hover:text-red-500 hover:bg-red-50 rounded-xl"}`,children:eD?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(R,{})," å·²æ ‡è®°ä¸ºåå·®æ ·æœ¬"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(B,{})," è®¤ä¸º AI ä¼°ç®—åå·®å¤§ï¼Ÿç‚¹å‡»æ ‡è®°æ ·æœ¬"]})})]})]})]})]}),eM&&(0,r.jsx)("div",{className:"fixed inset-0 z-[100] flex items-end justify-center px-4 pb-10 bg-black/60 backdrop-blur-sm animate-in fade-in",children:(0,r.jsxs)("div",{className:"w-full max-w-sm bg-white rounded-[2.5rem] p-8 space-y-6 shadow-2xl animate-in slide-in-from-bottom-10",children:[(0,r.jsxs)("div",{className:"space-y-2 text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-red-50 text-red-500 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)(P,{fill:"currentColor"})}),(0,r.jsx)("h3",{className:"text-2xl font-black text-gray-800",children:"å­˜ä¸ºå¸¸é¤æ¨¡ç‰ˆ"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"ä¸‹æ¬¡åƒåŒæ ·çš„é£Ÿç‰©ï¼Œä¸€é”®å¤ç”¨æ¨¡ç‰ˆæ¯”ä¾‹ï¼Œæ— éœ€å†æ¬¡æ‹æ‘„ã€‚"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest px-1",children:"é¤é£Ÿåç§°"}),(0,r.jsx)("input",{autoFocus:!0,value:eI,onChange:e=>eA(e.target.value),placeholder:"ä¾‹å¦‚ï¼šå…¬å¸é£Ÿå ‚é¸¡è‚‰ä¸¸å¥—é¤...",className:"w-full bg-gray-50 border-none rounded-2xl p-5 text-lg font-bold text-gray-800 focus:ring-2 focus:ring-green-500 outline-none"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3 pt-2",children:[(0,r.jsx)("button",{onClick:()=>eE(!1),className:"py-4 rounded-2xl font-bold text-gray-400 hover:bg-gray-50",children:"å–æ¶ˆ"}),(0,r.jsx)("button",{onClick:e2,className:"py-4 bg-green-600 text-white rounded-2xl font-black shadow-lg shadow-green-100 active:scale-95 transition-transform",children:"ç¡®è®¤ä¿å­˜"})]})]})}),es===a.HISTORY&&(0,r.jsxs)("div",{className:"animate-in slide-in-from-bottom-10 space-y-6 pb-20",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("button",{onClick:()=>ea(a.IDLE),className:"p-3 bg-white rounded-full text-gray-400 shadow-sm",children:(0,r.jsx)(N,{})}),(0,r.jsx)("h2",{className:"text-2xl font-black text-gray-800",children:"åŽ†å²è®°å½•"})]}),!e&&(0,r.jsxs)("div",{className:"bg-orange-50 border border-orange-100 rounded-2xl p-4 flex items-center gap-3",children:[(0,r.jsx)(B,{}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-xs font-bold text-orange-800",children:"æœªç™»å½•æ¨¡å¼"}),(0,r.jsx)("p",{className:"text-[10px] text-orange-600",children:"å½“å‰è®°å½•ä»…ä¿å­˜åœ¨æœ¬åœ°å†…å­˜ï¼Œå…³é—­é¡µé¢åŽå°†ä¸¢å¤±ã€‚ç™»å½•åŽå¯æ°¸ä¹…ä¿å­˜å¹¶å¤šç«¯åŒæ­¥ã€‚"})]}),(0,r.jsx)("button",{onClick:()=>q(!0),className:"px-3 py-1 bg-orange-600 text-white text-[10px] font-bold rounded-full",children:"ç™»å½•"})]}),(0,r.jsxs)("button",{onClick:()=>e?ea(a.CRITICAL_SAMPLES):q(!0),className:"w-full bg-red-50 border border-red-100 rounded-[1.5rem] p-4 flex items-center justify-between shadow-sm active:scale-95 transition-transform",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"p-2 bg-red-100 text-red-600 rounded-full",children:(0,r.jsx)(B,{})}),(0,r.jsxs)("div",{className:"text-left",children:[(0,r.jsx)("p",{className:"text-sm font-bold text-red-800",children:"åå·®æ ·æœ¬åº“"}),(0,r.jsx)("p",{className:"text-xs text-red-400",children:e?`å·²å½’æ¡£ ${ec.length} ä¸ª AI åå·®æ¡ˆä¾‹`:"ç™»å½•åŽæŸ¥çœ‹æ‚¨çš„çº åè®°å½•"})]})]}),(0,r.jsx)("div",{className:"text-red-300",children:(0,r.jsx)(M,{})})]}),(0,r.jsx)("div",{className:"space-y-4",children:en.length>0?en.map(e=>(0,r.jsxs)("div",{onClick:()=>{ex(e),ea(a.RESULT)},className:"bg-white rounded-[1.5rem] p-4 flex items-center gap-4 border border-gray-100 shadow-sm cursor-pointer hover:border-green-500 transition-colors group relative",children:[(0,r.jsx)("img",{src:e.imageUrl,className:"w-16 h-16 rounded-xl object-cover"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-sm font-black text-gray-800 line-clamp-1",children:e.description}),(0,r.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:[new Date(e.timestamp).toLocaleDateString()," â€¢ ",Math.round(e.items.reduce((e,t)=>e+(t.nutrients?.calories||0),0))," kcal"]})]}),(0,r.jsx)("button",{onClick:t=>e0(t,e.id),className:"p-2 text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all",children:(0,r.jsx)($,{})})]},e.id)):(0,r.jsxs)("div",{className:"py-20 text-center space-y-2 text-gray-300 italic",children:[(0,r.jsx)(y,{}),(0,r.jsx)("p",{children:"æš‚æ— è¯†åˆ«åŽ†å²"})]})})]}),es===a.CRITICAL_SAMPLES&&(0,r.jsxs)("div",{className:"animate-in slide-in-from-bottom-10 space-y-6 pb-20",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("button",{onClick:()=>ea(a.HISTORY),className:"p-3 bg-white rounded-full text-gray-400 shadow-sm",children:(0,r.jsx)(N,{})}),(0,r.jsx)("h2",{className:"text-xl font-black text-gray-800",children:"AI åå·®æ ·æœ¬åº“"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-500 px-1",children:"å½“æ‚¨å¯¹ AI çš„ä¼°ç®—ç»“æžœä¿®æ­£è¶…è¿‡ 30% æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å°†è¯¥æ ·æœ¬ä¿å­˜è‡³æ­¤ï¼Œä»¥ä¾¿åŽç»­åˆ†æžã€‚"}),(0,r.jsx)("div",{className:"space-y-4",children:ec.length>0?ec.map(e=>(0,r.jsxs)("div",{className:"bg-white rounded-[1.5rem] p-4 border border-red-100 shadow-sm space-y-3 relative group",children:[(0,r.jsx)("button",{onClick:t=>e1(t,e.id),className:"absolute top-4 right-4 p-2 text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all z-10",children:(0,r.jsx)($,{})}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("img",{src:e.imageUrl,className:"w-20 h-20 rounded-xl object-cover"}),(0,r.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,r.jsx)("p",{className:"text-sm font-black text-gray-800",children:e.foodName}),(0,r.jsx)("p",{className:"text-xs text-gray-400",children:new Date(e.timestamp).toLocaleDateString()}),(0,r.jsxs)("div",{className:"inline-block px-2 py-1 bg-red-100 text-red-600 rounded-lg text-[10px] font-bold mt-1",children:["åå·® ",e.deviationPercent>0?"+":"",e.deviationPercent,"%"]})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-xl p-3 flex justify-between items-center text-xs",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-gray-400 mb-1",children:"AI é¢„ä¼°"}),(0,r.jsxs)("p",{className:"font-black text-gray-800 text-lg",children:[Math.round(e.aiWeight),"g"]})]}),(0,r.jsx)("div",{className:"text-gray-300",children:"âž”"}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-gray-400 mb-1",children:"æ‚¨ä¿®æ­£ä¸º"}),(0,r.jsxs)("p",{className:"font-black text-green-600 text-lg",children:[Math.round(e.userWeight),"g"]})]})]})]},e.id)):(0,r.jsxs)("div",{className:"py-20 text-center space-y-2 text-gray-300 italic",children:[(0,r.jsx)(R,{}),(0,r.jsxs)("p",{children:["æš‚æ— ä¸¥é‡åå·®æ ·æœ¬",(0,r.jsx)("br",{}),"è¯´æ˜Ž AI æœ€è¿‘è¡¨çŽ°ä¸é”™ï¼"]})]})})]})]}),(0,r.jsx)("canvas",{ref:ez,className:"hidden"}),Z&&(0,r.jsx)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center px-4 bg-black/60 backdrop-blur-sm animate-in fade-in",children:(0,r.jsxs)("div",{className:"w-full max-w-sm bg-white rounded-[2.5rem] p-8 space-y-6 shadow-2xl animate-in zoom-in-95",children:[(0,r.jsxs)("div",{className:"space-y-2 text-center",children:[(0,r.jsx)("h3",{className:"text-2xl font-black text-gray-800",children:"login"===Y?"æ¬¢è¿Žå›žæ¥":"å¼€å¯å¥åº·ä¹‹æ—…"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"ç™»å½•åŽå¯åŒæ­¥æ‚¨çš„é£Ÿè°±å’Œå¸¸é¤æ¨¡ç‰ˆåˆ°æ‰€æœ‰è®¾å¤‡ã€‚"})]}),(0,r.jsxs)("form",{onSubmit:eV,className:"space-y-4",children:[et&&(0,r.jsx)("div",{className:"p-3 bg-red-50 text-red-500 text-xs font-bold rounded-xl",children:et}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest px-1",children:"é‚®ç®±åœ°å€"}),(0,r.jsx)("input",{required:!0,type:"email",value:V,onChange:e=>K(e.target.value),placeholder:"your@email.com",className:"w-full bg-gray-50 border-none rounded-2xl p-4 text-base font-bold text-gray-800 focus:ring-2 focus:ring-green-500 outline-none"})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest px-1",children:"å¯†ç "}),(0,r.jsx)("input",{required:!0,type:"password",value:J,onChange:e=>Q(e.target.value),placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",className:"w-full bg-gray-50 border-none rounded-2xl p-4 text-base font-bold text-gray-800 focus:ring-2 focus:ring-green-500 outline-none"})]}),(0,r.jsx)("button",{disabled:X,type:"submit",className:"w-full py-4 bg-gray-900 text-white rounded-2xl font-black shadow-lg active:scale-95 transition-transform",children:X?"è¯·ç¨å€™...":"login"===Y?"ç™»å½•":"ç«‹å³æ³¨å†Œ"})]}),(0,r.jsxs)("div",{className:"text-center pt-2",children:[(0,r.jsx)("button",{onClick:()=>H("login"===Y?"register":"login"),className:"text-xs font-bold text-green-600 hover:underline",children:"login"===Y?"è¿˜æ²¡æœ‰è´¦å·ï¼Ÿç‚¹å‡»æ³¨å†Œ":"å·²æœ‰è´¦å·ï¼Ÿç‚¹å‡»ç™»å½•"}),(0,r.jsx)("button",{onClick:()=>q(!1),className:"block w-full mt-4 text-xs font-bold text-gray-400 hover:text-gray-600",children:"ç¨åŽå†è¯´"})]})]})}),(es===a.IDLE||es===a.HISTORY||es===a.CRITICAL_SAMPLES)&&(0,r.jsxs)("nav",{className:"fixed bottom-8 inset-x-0 w-[85%] max-w-sm mx-auto bg-gray-900/90 backdrop-blur-xl border border-white/10 shadow-2xl rounded-[3rem] px-8 py-4 flex items-center justify-around z-40",children:[(0,r.jsx)("button",{onClick:()=>ea(a.IDLE),className:`p-2 transition-all ${es===a.IDLE?"text-green-500":"text-white/50"}`,children:(0,r.jsx)(A,{})}),(0,r.jsx)("button",{onClick:e4,className:"w-16 h-16 bg-green-500 text-white rounded-full -mt-16 border-[6px] border-gray-900 shadow-xl flex items-center justify-center active:scale-90 transition-transform",children:(0,r.jsx)(w,{})}),(0,r.jsx)("button",{onClick:()=>ea(a.HISTORY),className:`p-2 transition-all ${es===a.HISTORY||es===a.CRITICAL_SAMPLES?"text-green-500":"text-white/50"}`,children:(0,r.jsx)(y,{})})]})]})}e.s(["default",()=>z],31713)}]);