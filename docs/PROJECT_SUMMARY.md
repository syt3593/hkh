# NutriLens 项目总结文档

## 1. 项目简介
**NutriLens (AI 智能膳食分析)** 是一个基于 Next.js 和 Google Gemini AI 的现代化 Web 应用。它利用先进的图像识别技术，将用户的手机变成一台“智能食物秤”，帮助用户精准、便捷地记录和分析每日饮食的营养摄入。

## 2. 技术架构 (Technical Architecture)
- **核心框架**: Next.js 15+ (App Router) + React 19 + TypeScript
- **AI 引擎**: Google Generative AI (Gemini 3 Flash/Pro Preview)
- **样式方案**: Tailwind CSS 4.0
- **后端支持**: Next.js Route Handlers (用于安全调用 AI API 及数据预处理)
- **存储方案**: 
    - **本地存储 (localStorage)**: 存储识别历史、常餐模版和偏差样本。
    - **环境变量**: 采用服务器端 API Key 管理，增强安全性。
- **关键技术**:
    - **Vision AI**: 利用多模态大模型进行食物识别与体积估算。
    - **Web Speech API**: 支持语音录入补充信息（如：大份、加了油）。
    - **Canvas API**: 实现前端图片压缩，优化上传体验。

## 3. 核心功能 (Core Features)
- **双模式识餐**: 
    - **快速版 (Flash)**: 秒级响应，适合日常简单餐食。
    - **精细版 (Pro)**: 深度分析，适合复杂菜品或需要更高精度的场景。
- **智能纠偏系统**:
    - **全局总重调节**: 支持一键修改整餐总重，各成分按比例自动缩放。
    - **单品细化调节**: 点击单品可单独微调重量（支持 ±10% 快速按钮）或修改进食比例。
- **常餐模版 (Staple Meals)**: 支持将高频食用的餐食保存为模版，实现秒级记录。
- **偏差库 (Critical Samples)**: 自动捕捉或手动标记 AI 估算偏差较大的样本（>30%），为后续模型调优提供数据支撑。
- **营养看板与洞察**: 
    - 可视化展示热量及三大营养素。
    - **AI 洞察**: 根据当前餐食成分，给出即时的健康建议（如：“蛋白质充足，建议补充膳食纤维”）。
- **健康贴士**: 动态展示科学饮食冷知识，提升用户健康意识。

## 4. 当前现状
项目已完成从纯前端 Vite 架构向 Next.js 全栈架构的迁移，实现了：
1. **安全性提升**: API Key 不再暴露在前端。
2. **体验优化**: 引入了更智能的纠偏交互和模版复用逻辑。
3. **数据闭环**: 建立了偏差样本收集机制。

下一步计划：
- 接入数据库（如 Supabase/PostgreSQL）实现多端同步。
- 完善用户画像，提供更个性化的营养建议。
- 增加长期营养摄入趋势统计图表。
